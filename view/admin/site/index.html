<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="__ADMIN__/css/pearForm.css" />
    <link rel="stylesheet" href="__ADMIN__/layui/css/layui.css" />
    <style>
       body{margin: 10px;background-color: whitesmoke;}
    </style>
</head>
<body>
<div class="layui-row layui-col-space15">
    <div class="layui-col-md12">
        <div class="layui-card">
        <div class="layui-tab layui-tab-brief" lay-filter="TabBrief">
            <ul class="layui-tab-title">
                <li class="layui-this">网站设置</li>
                <li>邮箱设置</li>
                <li>上传设置</li>
            </ul>
            <div class="layui-tab-content">
                <div class="layui-tab-item layui-show">
                    <form class="layui-form" action="" lay-filter="component-form-element">
                        <div class="layui-form-item">
                            <label class="layui-form-label">
                                网站标题
                            </label>
                            <div class="layui-input-block">
                                <input autocomplete="off" class="layui-input" name="title" value="{$data['title']??''}" type="text"/>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">
                                网站关键词
                            </label>
                            <div class="layui-input-block">
                                <input autocomplete="off" class="layui-input"  name="key" value="{$data['key']??''}" type="text"/>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">
                                网站描述
                            </label>
                            <div class="layui-input-block">
                                <textarea name="desc" class="layui-textarea">{$data['desc']??''}</textarea>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">
                                网站LOGO
                            </label>
                            <button type="button" class="layui-btn" id="logo">
                                <i class="layui-icon">&#xe67c;</i>上传图片
                            </button>
                            <img {if condition="$data['logo'] neq ''"} src="{$data['logo']}" {/if} class="layui-upload-img" id="up_imglogo">
                            <input type="hidden" value="{$data['logo']??''}" name="logo" id="up_img_urllogo">
                        </div>
                        <div class="layui-form-item">
                            <div class="layui-input-block">
                                <button type="submit" class="layui-btn layui-btn-normal" lay-submit="" lay-filter="save">保存设置</button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="layui-tab-item">
                    <form class="layui-form" action="" lay-filter="component-form-element">
                        <div class="layui-form-item">
                            <label class="layui-form-label">
                                邮箱账号
                            </label>
                            <div class="layui-input-block">
                                <input autocomplete="off" class="layui-input" name="smtp-user" value="{$data['smtp-user']??''}" type="text"/>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">
                                邮箱密匙
                            </label>
                            <div class="layui-input-block">
                                <input autocomplete="off" class="layui-input"  name="smtp-pass" value="{$data['smtp-pass']??''}" type="text"/>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">
                                邮箱端口
                            </label>
                            <div class="layui-input-block">
                                <input autocomplete="off" class="layui-input"  name="smtp-port" value="{$data['smtp-port']??''}" type="text"/>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <label class="layui-form-label">
                                邮箱服务器
                            </label>
                            <div class="layui-input-block">
                                <input autocomplete="off" class="layui-input"  name="smtp-host" value="{$data['smtp-host']??''}" type="text"/>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <div class="layui-input-block">
                                <button type="submit" class="layui-btn layui-btn-normal" lay-submit="" lay-filter="save">保存设置</button>
                            </div>
                        </div>
                     </form>
                </div>
                <div class="layui-tab-item">
                    <form class="layui-form" action="" lay-filter="component-form-element">
                        <div class="layui-form-item">
                            <label class="layui-form-label">存储方式</label>
                            <div class="layui-input-block">
                              <input type="radio" name="file-type" value="1" title="本地" {if condition="$data['file-type'] eq 1"} checked {/if} lay-filter="type">
                              <input type="radio" name="file-type" value="2" title="阿里云" {if condition="$data['file-type'] eq 2"} checked {/if} lay-filter="type">
                            </div>
                        </div>
                        <div class="layui-form-item" id="oss" {if condition="$data['file-type'] neq 2"} style="display: none;" {/if}>
                            <div class="layui-form-item">
                                <label class="layui-form-label">Oss地址</label>
                                <div class="layui-input-block">
                                    <input type="text" name="file-endpoint"  value="{$data['file-endpoint']??''}"  placeholder="请输入Oss地址" autocomplete="off" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">空间名称</label>
                                <div class="layui-input-block">
                                    <input type="text" name="file-OssName"   value="{$data['file-OssName']??''}" placeholder="请输入空间名称" autocomplete="off" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">KeyId</label>
                                <div class="layui-input-block">
                                    <input type="text" name="file-accessKeyId"   value="{$data['file-accessKeyId']??''}" placeholder="请输入KeyId" autocomplete="off" class="layui-input">
                                </div>
                            </div>
                            <div class="layui-form-item">
                                <label class="layui-form-label">KeySecret</label>
                                <div class="layui-input-block">
                                    <input type="text" name="file-accessKeySecret"   value="{$data['file-accessKeySecret']??''}"  placeholder="请输入KeySecret" autocomplete="off" class="layui-input">
                                </div>
                            </div>
                        </div>
                        <div class="layui-form-item">
                            <div class="layui-input-block">
                                <button type="submit" class="layui-btn layui-btn-normal" lay-submit="" lay-filter="save">保存设置</button>
                            </div>
                        </div>
                     </form>
                </div>
                </div>
            </div>      
        </div>
    </div>
</div>
<script src="__ADMIN__/layui/layui.js"></script>
<script>
 layui.use(['jquery','form','layer','element','upload'],function () {
        var $=layui.jquery;
        var form=layui.form;
        var layer=layui.layer;
        var element = layui.element;
        var upload = layui.upload;

        form.on('radio(type)', function(data){
            if(data.value==2){
                $("#oss").show();
            }else{
				$("#oss").hide();
            }
        });  
       upload.render({
            elem: '#logo' //绑定元素
            ,url: '/uploads' //上传接口
            ,done: function(res, index, upload){
                var item = this.item;
                var getId=item.context.id;
                $('#up_img'+getId).attr('src',res.data);
                $('#up_img_url'+getId).val(res.data);
            }
        });

        form.on('submit(save)',function (data) {
            var load = layer.load();
            $.post("/site/index",data.field,function (res) {
                layer.close(load);
                if (res.code==1){
                    layer.msg(res.msg,{icon:1,time:1500},function () {
                    })
                } else {
                    layer.msg(res.msg,{icon:2,time:1500})
                }
            });
            return false
        })
        var layid = location.hash.replace(/^#TabBrief=/, '');
        element.tabChange('TabBrief', layid); 
        element.on('tab(TabBrief)', function(){
            location.hash = 'TabBrief='+ this.getAttribute('lay-id');
        });

    })
</script>
</body>
</html>